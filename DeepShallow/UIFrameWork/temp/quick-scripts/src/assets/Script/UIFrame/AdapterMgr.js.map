{"version":3,"sources":["assets/Script/UIFrame/AdapterMgr.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["/**\n * @Author: 邓朗 \n * @Date: 2019-06-12 17:18:04  \n * @Describe: 适配组件, 主要适配背景大小,窗体的位置\n */\n\nlet flagOffset = 0;\nconst _None = 1 << flagOffset ++;\nconst _Left = 1 << flagOffset ++;            // 左对齐\nconst _Right = 1 << flagOffset ++;           // 右对齐\nconst _Top = 1 << flagOffset ++;             // 上对齐\nconst _Bottom = 1 << flagOffset ++;          // 下对齐\nconst _StretchWidth = _Left | _Right;          // 拉伸宽\nconst _StretchHeight = _Top | _Bottom;         // 拉伸高\n\nconst _FullWidth = 1 << flagOffset ++;       // 等比充满宽\nconst _FullHeight = 1 << flagOffset ++;      // 等比充满高\nconst _Final = 1 << flagOffset++;\n\n/**  */\nexport enum AdapterType {\n    Top = _Top,\n    Bottom = _Bottom,\n    Left = _Left,\n    Right = _Right,\n\n    StretchWidth = _StretchWidth,\n    StretchHeight = _StretchHeight,\n\n    FullWidth = _FullWidth,\n    FullHeight = _FullHeight,\n}\n\nconst {ccclass, property} = cc._decorator;\n\n@ccclass\nexport default class AdapterMgr {\n\n    private static _instance: AdapterMgr = null;                     // 单例\n    public static get inst() {\n        if(this._instance == null) {\n            this._instance = new AdapterMgr();       \n            this._instance.visibleSize = cc.view.getVisibleSize();\n            console.log(`visiable size: ${this._instance.visibleSize}`);\n        }\n        return this._instance;\n    }\n    \n    /** 屏幕尺寸 */\n    public visibleSize: cc.Size;\n\n    public adapteByType(flag: number, node: cc.Node, distance = 0) {\n        let tFlag = _Final;\n        while (tFlag > 0) {\n            if (tFlag & flag)\n                this._doAdapte(tFlag, node, distance);\n            tFlag = tFlag >> 1;\n        }\n        let widget = node.getComponent(cc.Widget);\n        widget.target = cc.find(\"Canvas\");\n        widget.updateAlignment();\n    }\n\n    private _doAdapte(flag: number, node: cc.Node, distance: number = 0) {\n        let widget = node.getComponent(cc.Widget);\n        if(!widget) {\n            widget = node.addComponent(cc.Widget);\n        }\n        switch(flag) {\n            case _None:\n                break;\n            case _Left:\n                widget.isAlignLeft = true;\n                widget.isAbsoluteLeft = true;\n                widget.left = distance ? distance : 0;\n                break;\n            case _Right:\n                widget.isAlignRight = true;\n                widget.isAbsoluteRight = true;\n                widget.right = distance ? distance : 0;\n                break;\n            case _Top:\n                if(cc.sys.platform === cc.sys.WECHAT_GAME) {     // 微信小游戏适配刘海屏\n                    let menuInfo = window[\"wx\"].getMenuButtonBoundingClientRect();\n                    let systemInfo = window[\"wx\"].getSystemInfoSync();\n                    distance += cc.find(\"Canvas\").height * (menuInfo.top / systemInfo.screenHeight);\n                }\n                widget.isAlignTop = true;\n                widget.isAbsoluteTop = true;\n                widget.top = distance ? distance : 0;\n                break;\n            case _Bottom:\n                widget.isAlignBottom = true;\n                widget.isAbsoluteBottom = true;\n                widget.bottom = distance ? distance : 0;\n                break;\n            case _FullWidth:\n                node.height /= node.width / this.visibleSize.width;\n                node.width = this.visibleSize.width;\n                break;\n            case _FullHeight:\n                node.width /= node.height / this.visibleSize.height;\n                node.height = this.visibleSize.height;\n                break;\n        }\n    }\n\n\n    /** 移除 */\n    removeAdaptater(node: cc.Node) {\n        if(node.getComponent(cc.Widget)) {\n            node.removeComponent(cc.Widget);\n        }\n    }\n}\n"]}