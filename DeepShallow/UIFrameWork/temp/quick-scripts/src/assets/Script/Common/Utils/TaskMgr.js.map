{"version":3,"sources":["assets/Script/Common/Utils/TaskMgr.ts"],"names":[],"mappings":";;;;;;;AAAA,iDAA4C;AAE5C;;;GAGG;AACH,IAAY,WAEX;AAFD,WAAY,WAAW;IACnB,UAAU;AACd,CAAC,EAFW,WAAW,GAAX,mBAAW,KAAX,mBAAW,QAEtB;AACD;IAAA;IAGA,CAAC;IAAD,cAAC;AAAD,CAHA,AAGC,IAAA;AAHY,0BAAO;AAKpB,WAAW;AACX;IAAA;QAUY,YAAO,GAA2C,EAAE,CAAC,EAAE,CAAC,SAAS,EAAE,CAAC;QACpE,kBAAa,GAAmB,EAAE,CAAC;QAEnC,WAAM,GAAG,KAAK,CAAC;IAsC3B,CAAC;IAhDG,sBAAkB,eAAI;aAAtB;YACI,IAAG,CAAC,IAAI,CAAC,SAAS,EAAE;gBAChB,IAAI,CAAC,SAAS,GAAG,IAAI,OAAO,EAAE,CAAC;aAClC;YACD,OAAO,IAAI,CAAC,SAAS,CAAC;QAC1B,CAAC;;;OAAA;IAMM,0BAAQ,GAAf,UAAgB,KAAY;QAAZ,sBAAA,EAAA,YAAY;QACxB,IAAI,CAAC,MAAM,GAAG,KAAK,CAAC;IACxB,CAAC;IAED;;;OAGG;IACI,6BAAW,GAAlB,UAAmB,GAAW,EAAE,OAAgB,EAAE,IAAgB;QAAhB,qBAAA,EAAA,QAAgB;QAC9D,IAAG,IAAI,CAAC,MAAM,EAAE;YACZ,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;SACpC;QACD,IAAI,QAAQ,GAAG,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,CAAC;QACjC,IAAG,CAAC,QAAQ,EAAE;YACV,QAAQ,GAAG,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,GAAG,IAAI,uBAAa,EAAW,CAAC;SAC/D;QACD,QAAQ,CAAC,OAAO,CAAC,OAAO,EAAE,IAAI,CAAC,CAAC;IACpC,CAAC;IAED,aAAa;IACN,4BAAU,GAAjB,UAAkB,GAAW;QACzB,IAAI,QAAQ,GAAG,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,CAAC;QACjC,IAAG,CAAC,QAAQ;YAAE,OAAO,IAAI,CAAC;QAC1B,OAAO,QAAQ,CAAC,OAAO,EAAE,CAAC;IAC9B,CAAC;IAED,cAAc;IACP,4BAAU,GAAjB,UAAkB,GAAY,EAAE,GAAY;QACxC,IAAG,GAAG,EAAE;YACJ,IAAI,QAAQ,GAAG,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,CAAC;YACjC,OAAO,QAAQ,CAAC,UAAU,CAAC,GAAG,CAAC,CAAC;SACnC;QACD,KAAI,IAAI,KAAG,IAAI,IAAI,CAAC,OAAO,EAAE;YACzB,IAAG,IAAI,CAAC,OAAO,CAAC,KAAG,CAAC,CAAC,UAAU,CAAC,GAAG,CAAC;gBAAE,OAAO,IAAI,CAAC;SACrD;QACD,OAAO,KAAK,CAAC;IACjB,CAAC;IAhDc,iBAAS,GAAY,IAAI,CAAC;IAiD7C,cAAC;CAnDD,AAmDC,IAAA;kBAnDoB,OAAO","file":"","sourceRoot":"/","sourcesContent":["import PriorityQueue from \"./PriorityQueue\";\n\n/**\n * author: denglang\n * desc: 一个命令队列， \n */\nexport enum CommandType {\n    // 自定义命令类型\n}\nexport class Command {\n    type: CommandType;\n    data: any;\n}\n\n/** 命令队列 */\nexport default class TaskMgr {\n\n    private static _instance: TaskMgr = null;\n    public static get inst() {\n        if(!this._instance) {\n            this._instance = new TaskMgr();\n        }\n        return this._instance;\n    }\n\n    private _cmdMap: {[key:string]: PriorityQueue<Command>} = cc.js.createMap(); \n    private _debugHistory: Array<Command> = [];\n\n    private _debug = false;\n    public setDebug(debug = true) {\n        this._debug = debug;\n    }\n\n    /**\n     * @param command 命令\n     * @param pIdx 优先级 数值越大优先级越高  默认是0\n     */\n    public pushCommand(key: string, command: Command, pIdx: number = 0) {\n        if(this._debug) {\n            this._debugHistory.push(command);\n        }\n        let cmdQueue = this._cmdMap[key];\n        if(!cmdQueue) {\n            cmdQueue = this._cmdMap[key] = new PriorityQueue<Command>();\n        }\n        cmdQueue.enqueue(command, pIdx);\n    }\n\n    /** 获得一个命令 */\n    public popCommand(key: string) {\n        let cmdQueue = this._cmdMap[key];\n        if(!cmdQueue) return null;\n        return cmdQueue.dequeue();\n    }\n\n    /** 是否有这个命令 */\n    public hasCommand(ele: Command, key?: string) {\n        if(key) {\n            let cmdQueue = this._cmdMap[key];\n            return cmdQueue.hasElement(ele);\n        }\n        for(let key in this._cmdMap) {\n            if(this._cmdMap[key].hasElement(ele)) return true;\n        }\n        return false;\n    }\n}\n"]}