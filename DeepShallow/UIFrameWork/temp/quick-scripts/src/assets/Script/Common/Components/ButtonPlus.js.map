{"version":3,"sources":["assets/Script/Common/Components/ButtonPlus.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import SoundMgr from \"../../UIFrame/SoundMgr\";\n\nconst {ccclass, property, executeInEditMode, menu, help, inspector} = cc._decorator;\n@ccclass\n@menu('i18n:MAIN_MENU.component.ui/ButtonPlus')\n@executeInEditMode\n@help('i18n:COMPONENT.help_url.button')\n@inspector('packages://buttonplus/inspector.js')\nexport default class ButtonPlus extends cc.Button {\n\n    @property({tooltip:\"音效路径\", type: '', multiline: true, formerlySerializedAs: '_N$string'})\n    audioUrl = '';\n    @property({tooltip: \"屏蔽连续点击\"})\n    openContinuous = true;\n    @property({tooltip:\"屏蔽时间, 单位:秒\"})\n    continuousTime = 1;\n\n    // false表示可以点击\n    continuous: boolean = false;\n    // 定时器\n    _continuousTimer = null;\n    \n\n    // 长按触发\n    @property({tooltip: \"是否开启长按事件\"})\n    openLongPress = false;\n    // 触发时间\n    @property({tooltip: \"长按时间\"})\n    longPressTime = 1;\n    longPressFlag = false;\n\n    private longPressTimer = null;\n    \n    onEnable() {\n        this.continuous = false;\n        super.onEnable();\n        if (!CC_EDITOR) {\n        }\n    }\n    onDisable() {\n        if (this._continuousTimer) {\n            clearTimeout(this._continuousTimer);\n            this._continuousTimer = null;\n        }\n        if(this.longPressTimer) {\n            clearTimeout(this.longPressTimer);\n            this.longPressTimer = null;\n        }\n        super.onDisable();\n    }\n\n    /** 重写 */\n    _onTouchBegan (event) {\n        if (!this.interactable || !this.enabledInHierarchy) return;\n \n        if(this.openLongPress && !this.longPressFlag) {    // 开启长按\n            if(this.longPressTimer) clearTimeout(this.longPressTimer);\n            this.longPressTimer = setTimeout(function() {\n                // 还在触摸中 触发事件\n                if(this[\"_pressed\"]) {\n                    this.node.emit('longclickStart', this);\n                    this.longPressFlag = true;\n                }\n            }.bind(this), this.longPressTime * 1000);\n        }\n\n        this[\"_pressed\"] = true;\n        this[\"_updateState\"]();\n        event.stopPropagation();\n    }\n    _onTouchEnded(event) {\n        if (!this.interactable || !this.enabledInHierarchy) return;\n        if(this[\"_pressed\"] && this.longPressFlag) {\n            this.node.emit('longclickEnd', this);\n            this.longPressFlag = false;\n        } else if (this[\"_pressed\"] && !this.continuous) {\n            this.continuous = this.openContinuous ? true : false;\n            cc.Component.EventHandler.emitEvents(this.clickEvents, event);\n            this.node.emit('click', event);\n            SoundMgr.inst.playEffect(this.audioUrl)\n            if (this.openContinuous) {\n               this._continuousTimer = setTimeout(function(){\n                    this.continuous = false;\n                }.bind(this), this.continuousTime * 1000);\n            }\n        }\n        this[\"_pressed\"] = false;\n        this[\"_updateState\"]();\n        event.stopPropagation();\n    }\n    _onTouchCancel () {\n        if (!this.interactable || !this.enabledInHierarchy) return;\n        if(this[\"_pressed\"] && this.longPressFlag) {\n            this.node.emit('longclickEnd', this);\n            this.longPressFlag = false;\n        }\n        this[\"_pressed\"] = false;\n        this[\"_updateState\"]();\n    }\n    /** 添加点击事件 */\n    addClick(callback: Function, target: Object) {\n        this.node.off('click');\n        this.node.on('click', callback, target);\n    }\n    /** 添加一个长按事件 */\n    addLongClick(startFunc: Function, endFunc: Function, target: Object) {\n        this.node.off('longclickStart');\n        this.node.off('longclickEnd');\n        this.node.on('longclickStart', startFunc, target);\n        this.node.on('longclickEnd', endFunc, target);\n    }\n}"]}