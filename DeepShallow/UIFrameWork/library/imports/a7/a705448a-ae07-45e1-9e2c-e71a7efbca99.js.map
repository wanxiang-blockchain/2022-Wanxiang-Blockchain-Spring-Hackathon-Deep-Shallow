{"version":3,"sources":["assets/Script/Common/StateMachine/StateMachine.js"],"names":["StateMachine","VERSION","Result","SUCCEEDED","NOTRANSITION","CANCELLED","PENDING","Error","INVALID_TRANSITION","PENDING_TRANSITION","INVALID_CALLBACK","WILDCARD","ASYNC","create","cfg","target","initial","state","terminal","fsm","events","callbacks","map","transitions","add","e","from","Array","isArray","name","n","length","push","to","event","hasOwnProperty","buildEvent","current","is","indexOf","can","transition","undefined","cannot","concat","isFinished","error","args","msg","states","Object","keys","sort","defer","doCallback","func","apply","beforeAnyEvent","afterAnyEvent","leaveAnyState","enterAnyState","changeState","beforeThisEvent","afterThisEvent","leaveThisState","enterThisState","beforeEvent","afterEvent","leaveState","specific","general","enterState","prototype","slice","call","arguments","cancel","leave","exports","module","define","amd","require","window","self"],"mappings":"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","sourceRoot":"/","sourcesContent":["/*\n  Javascript State Machine Library - https://github.com/jakesgordon/javascript-state-machine\n  Copyright (c) 2012, 2013, 2014, 2015, Jake Gordon and contributors\n  Released under the MIT license - https://github.com/jakesgordon/javascript-state-machine/blob/master/LICENSE\n*/\n\n(function () {\n\n    var StateMachine = {\n  \n      //---------------------------------------------------------------------------\n  \n      VERSION: \"2.4.0\",\n  \n      //---------------------------------------------------------------------------\n  \n      Result: {\n        SUCCEEDED:    1, // the event transitioned successfully from one state to another\n        NOTRANSITION: 2, // the event was successfull but no state transition was necessary\n        CANCELLED:    3, // the event was cancelled by the caller in a beforeEvent callback\n        PENDING:      4  // the event is asynchronous and the caller is in control of when the transition occurs\n      },\n  \n      Error: {\n        INVALID_TRANSITION: 100, // caller tried to fire an event that was innapropriate in the current state\n        PENDING_TRANSITION: 200, // caller tried to fire an event while an async transition was still pending\n        INVALID_CALLBACK:   300 // caller provided callback function threw an exception\n      },\n  \n      WILDCARD: '*',\n      ASYNC: 'async',\n  \n      //---------------------------------------------------------------------------\n  \n      create: function(cfg, target) {\n  \n        var initial      = (typeof cfg.initial == 'string') ? { state: cfg.initial } : cfg.initial; // allow for a simple string, or an object with { state: 'foo', event: 'setup', defer: true|false }\n        var terminal     = cfg.terminal || cfg['final'];\n        var fsm          = target || cfg.target  || {};\n        var events       = cfg.events || [];\n        var callbacks    = cfg.callbacks || {};\n        var map          = {}; // track state transitions allowed for an event { event: { from: [ to ] } }\n        var transitions  = {}; // track events allowed from a state            { state: [ event ] }\n  \n        var add = function(e) {\n          var from = Array.isArray(e.from) ? e.from : (e.from ? [e.from] : [StateMachine.WILDCARD]); // allow 'wildcard' transition if 'from' is not specified\n          map[e.name] = map[e.name] || {};\n          for (var n = 0 ; n < from.length ; n++) {\n            transitions[from[n]] = transitions[from[n]] || [];\n            transitions[from[n]].push(e.name);\n  \n            map[e.name][from[n]] = e.to || from[n]; // allow no-op transition if 'to' is not specified\n          }\n          if (e.to)\n            transitions[e.to] = transitions[e.to] || [];\n        };\n  \n        if (initial) {\n          initial.event = initial.event || 'startup';\n          add({ name: initial.event, from: 'none', to: initial.state });\n        }\n  \n        for(var n = 0 ; n < events.length ; n++)\n          add(events[n]);\n  \n        for(var name in map) {\n          if (map.hasOwnProperty(name))\n            fsm[name] = StateMachine.buildEvent(name, map[name]);\n        }\n  \n        for(var name in callbacks) {\n          if (callbacks.hasOwnProperty(name))\n            fsm[name] = callbacks[name]\n        }\n  \n        fsm.current     = 'none';\n        fsm.is          = function(state) { return Array.isArray(state) ? (state.indexOf(this.current) >= 0) : (this.current === state); };\n        fsm.can         = function(event) { return !this.transition && (map[event] !== undefined) && (map[event].hasOwnProperty(this.current) || map[event].hasOwnProperty(StateMachine.WILDCARD)); }\n        fsm.cannot      = function(event) { return !this.can(event); };\n        fsm.transitions = function()      { return (transitions[this.current] || []).concat(transitions[StateMachine.WILDCARD] || []); };\n        fsm.isFinished  = function()      { return this.is(terminal); };\n        fsm.error       = cfg.error || function(name, from, to, args, error, msg, e) { throw e || msg; }; // default behavior when something unexpected happens is to throw an exception, but caller can override this behavior if desired (see github issue #3 and #17)\n        fsm.states      = function() { return Object.keys(transitions).sort() };\n  \n        if (initial && !initial.defer)\n          fsm[initial.event]();\n  \n        return fsm;\n  \n      },\n  \n      //===========================================================================\n  \n      doCallback: function(fsm, func, name, from, to, args) {\n        if (func) {\n          try {\n            return func.apply(fsm, [name, from, to].concat(args));\n          }\n          catch(e) {\n            return fsm.error(name, from, to, args, StateMachine.Error.INVALID_CALLBACK, \"an exception occurred in a caller-provided callback function\", e);\n          }\n        }\n      },\n  \n      beforeAnyEvent:  function(fsm, name, from, to, args) { return StateMachine.doCallback(fsm, fsm['onbeforeevent'],                       name, from, to, args); },\n      afterAnyEvent:   function(fsm, name, from, to, args) { return StateMachine.doCallback(fsm, fsm['onafterevent'] || fsm['onevent'],      name, from, to, args); },\n      leaveAnyState:   function(fsm, name, from, to, args) { return StateMachine.doCallback(fsm, fsm['onleavestate'],                        name, from, to, args); },\n      enterAnyState:   function(fsm, name, from, to, args) { return StateMachine.doCallback(fsm, fsm['onenterstate'] || fsm['onstate'],      name, from, to, args); },\n      changeState:     function(fsm, name, from, to, args) { return StateMachine.doCallback(fsm, fsm['onchangestate'],                       name, from, to, args); },\n  \n      beforeThisEvent: function(fsm, name, from, to, args) { return StateMachine.doCallback(fsm, fsm['onbefore' + name],                     name, from, to, args); },\n      afterThisEvent:  function(fsm, name, from, to, args) { return StateMachine.doCallback(fsm, fsm['onafter'  + name] || fsm['on' + name], name, from, to, args); },\n      leaveThisState:  function(fsm, name, from, to, args) { return StateMachine.doCallback(fsm, fsm['onleave'  + from],                     name, from, to, args); },\n      enterThisState:  function(fsm, name, from, to, args) { return StateMachine.doCallback(fsm, fsm['onenter'  + to]   || fsm['on' + to],   name, from, to, args); },\n  \n      beforeEvent: function(fsm, name, from, to, args) {\n        if ((false === StateMachine.beforeThisEvent(fsm, name, from, to, args)) ||\n            (false === StateMachine.beforeAnyEvent( fsm, name, from, to, args)))\n          return false;\n      },\n  \n      afterEvent: function(fsm, name, from, to, args) {\n        StateMachine.afterThisEvent(fsm, name, from, to, args);\n        StateMachine.afterAnyEvent( fsm, name, from, to, args);\n      },\n  \n      leaveState: function(fsm, name, from, to, args) {\n        var specific = StateMachine.leaveThisState(fsm, name, from, to, args),\n            general  = StateMachine.leaveAnyState( fsm, name, from, to, args);\n        if ((false === specific) || (false === general))\n          return false;\n        else if ((StateMachine.ASYNC === specific) || (StateMachine.ASYNC === general))\n          return StateMachine.ASYNC;\n      },\n  \n      enterState: function(fsm, name, from, to, args) {\n        StateMachine.enterThisState(fsm, name, from, to, args);\n        StateMachine.enterAnyState( fsm, name, from, to, args);\n      },\n  \n      //===========================================================================\n  \n      buildEvent: function(name, map) {\n        return function() {\n  \n          var from  = this.current;\n          var to    = map[from] || (map[StateMachine.WILDCARD] != StateMachine.WILDCARD ? map[StateMachine.WILDCARD] : from) || from;\n          var args  = Array.prototype.slice.call(arguments); // turn arguments into pure array\n  \n          if (this.transition)\n            return this.error(name, from, to, args, StateMachine.Error.PENDING_TRANSITION, \"event \" + name + \" inappropriate because previous transition did not complete\");\n  \n          if (this.cannot(name))\n            return this.error(name, from, to, args, StateMachine.Error.INVALID_TRANSITION, \"event \" + name + \" inappropriate in current state \" + this.current);\n  \n          if (false === StateMachine.beforeEvent(this, name, from, to, args))\n            return StateMachine.Result.CANCELLED;\n  \n          if (from === to) {\n            StateMachine.afterEvent(this, name, from, to, args);\n            return StateMachine.Result.NOTRANSITION;\n          }\n  \n          // prepare a transition method for use EITHER lower down, or by caller if they want an async transition (indicated by an ASYNC return value from leaveState)\n          var fsm = this;\n          this.transition = function() {\n            fsm.transition = null; // this method should only ever be called once\n            fsm.current = to;\n            StateMachine.enterState( fsm, name, from, to, args);\n            StateMachine.changeState(fsm, name, from, to, args);\n            StateMachine.afterEvent( fsm, name, from, to, args);\n            return StateMachine.Result.SUCCEEDED;\n          };\n          this.transition.cancel = function() { // provide a way for caller to cancel async transition if desired (issue #22)\n            fsm.transition = null;\n            StateMachine.afterEvent(fsm, name, from, to, args);\n          }\n  \n          var leave = StateMachine.leaveState(this, name, from, to, args);\n          if (false === leave) {\n            this.transition = null;\n            return StateMachine.Result.CANCELLED;\n          }\n          else if (StateMachine.ASYNC === leave) {\n            return StateMachine.Result.PENDING;\n          }\n          else {\n            if (this.transition) // need to check in case user manually called transition() but forgot to return StateMachine.ASYNC\n              return this.transition();\n          }\n  \n        };\n      }\n  \n    }; // StateMachine\n  \n    //===========================================================================\n  \n    //======\n    // NODE\n    //======\n    if (typeof exports !== 'undefined') {\n      if (typeof module !== 'undefined' && module.exports) {\n        exports = module.exports = StateMachine;\n      }\n      exports.StateMachine = StateMachine;\n    }\n    //============\n    // AMD/REQUIRE\n    //============\n    else if (typeof define === 'function' && define.amd) {\n      define(function(require) { return StateMachine; });\n    }\n    //========\n    // BROWSER\n    //========\n    else if (typeof window !== 'undefined') {\n      window.StateMachine = StateMachine;\n    }\n    //===========\n    // WEB WORKER\n    //===========\n    else if (typeof self !== 'undefined') {\n      self.StateMachine = StateMachine;\n    }\n  \n  }());"]}