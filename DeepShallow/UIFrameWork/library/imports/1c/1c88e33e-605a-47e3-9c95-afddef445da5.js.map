{"version":3,"sources":["assets/Script/Common/Components/TouchPlus.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["const {ccclass, property} = cc._decorator;\n\n@ccclass\nexport default class TouchPlus extends cc.Component {\n\n    private offset  = 15;       // 误差值\n    private startPosition: cc.Vec2;\n    private isTouch = false;\n\n    private isClick = true;\n\n    private clickEvent: Function;\n    private slideEvent: (e: cc.Event.EventTouch) => any;\n\n    /** 添加点击事件和滑动事件 */\n    public addEvent(click: Function, slide: (e: cc.Event.EventTouch) => any) {\n        this.clickEvent = click;\n        this.slideEvent = slide;\n    }\n\n    // onLoad () {}\n\n    start () {\n        this.node.on(cc.Node.EventType.TOUCH_START, this.touchStart, this);\n        this.node.on(cc.Node.EventType.TOUCH_MOVE, this.touchMove, this);\n        this.node.on(cc.Node.EventType.TOUCH_END, this.touchEnd, this);\n        this.node.on(cc.Node.EventType.TOUCH_CANCEL, this.touchCancel, this);\n    }\n\n\n    private touchStart(e: cc.Event.EventTouch) {\n        this.isTouch = true;\n        this.startPosition = e.getLocation();\n    }\n    private touchMove(e: cc.Event.EventTouch) {\n        if(!this.isTouch) return ;\n        let pos = e.getLocation();\n        let len = pos.sub(this.startPosition).mag();\n        if(len > this.offset) {\n            this.isClick = false;\n            // 触发滑动\n            this.slideEvent && this.slideEvent(e);\n        }\n    }\n    private touchEnd(e: cc.Event.EventTouch) {\n        if(!this.isTouch) return ;\n        this.isTouch = false;\n        \n        this.isClick && this.clickEvent && this.clickEvent(e);\n\n        this.isClick = true;\n    }\n    private touchCancel(e: cc.Event.EventTouch) {\n        if(!this.isTouch) return ;\n        this.isTouch = false;\n\n        this.isClick = true;\n    }\n\n    onDestroy() {\n        this.node.off(cc.Node.EventType.TOUCH_START, this.touchStart, this);\n        this.node.off(cc.Node.EventType.TOUCH_MOVE, this.touchMove, this);\n        this.node.off(cc.Node.EventType.TOUCH_END, this.touchEnd, this);\n        this.node.off(cc.Node.EventType.TOUCH_CANCEL, this.touchCancel, this);\n    }\n\n    // update (dt) {}\n}\n"]}