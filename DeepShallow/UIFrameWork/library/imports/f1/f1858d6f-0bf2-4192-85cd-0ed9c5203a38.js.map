{"version":3,"sources":["assets/Script/UIFrame/UIManager.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import UIBase from \"./UIBase\";\nimport { SysDefine, FormType } from \"./config/SysDefine\";\nimport ResMgr from \"./ResMgr\";\nimport ModalMgr from \"./ModalMgr\";\nimport AdapterMgr, { AdapterType } from \"./AdapterMgr\";\nimport Scene from \"../Scene/Scene\";\nimport { UIWindow } from \"./UIForm\";\nimport { ECloseType, IFormData } from \"./Struct\";\nimport { EventCenter } from \"./EventCenter\";\nimport { EventType } from \"./EventType\";\nimport { LRUCache } from \"../Common/Utils/LRUCache\";\n\n/**\n * @author honmono\n */\nexport default class UIManager {    \n    private _UIROOT: cc.Node = null;    // UIROOT\n    private _ndScreen: cc.Node = null;  // 全屏显示的UI 挂载结点\n    private _ndFixed: cc.Node  = null;  // 固定显示的UI\n    private _ndPopUp: cc.Node  = null;  // 弹出窗口\n    private _ndTips: cc.Node   = null;  // 独立窗体\n\n    private _windows: UIWindow[]                                       = [];                   // 存储弹出的窗体\n    private _allForms: {[key: string]: UIBase}                         = cc.js.createMap();    // 所有已经挂载的窗体, 可能没有显示\n    private _showingForms: {[key: string]: UIBase}                     = cc.js.createMap();    // 正在显示的窗体\n    private _tipsForms: {[key: string]: UIBase}                        = cc.js.createMap();    // 独立窗体 独立于其他窗体, 不受其他窗体的影响\n    private _loadingForm: {[key: string]: ((value: UIBase) => void)[]} = cc.js.createMap();    // 正在加载的form\n    private _LRUCache: LRUCache = new LRUCache(3);                                             // LRU cache\n    \n    private static instance: UIManager = null;                                                 // 单例\n    public static getInstance(): UIManager {\n        if(this.instance == null) {\n            this.instance = new UIManager();\n            let canvas = cc.director.getScene().getChildByName(\"Canvas\");\n            let scene = canvas.getChildByName(SysDefine.SYS_SCENE_NODE);\n            if(!scene) {\n                scene = new cc.Node(SysDefine.SYS_SCENE_NODE);\n                scene.addComponent(Scene);\n                scene.parent = canvas;\n            }\n            let UIROOT = this.instance._UIROOT = new cc.Node(SysDefine.SYS_UIROOT_NODE);\n            scene.addChild(UIROOT);\n\n            UIROOT.addChild(this.instance._ndScreen = new cc.Node(SysDefine.SYS_SCREEN_NODE));\n            UIROOT.addChild(this.instance._ndFixed = new cc.Node(SysDefine.SYS_FIXED_NODE));\n            UIROOT.addChild(this.instance._ndPopUp = new cc.Node(SysDefine.SYS_POPUP_NODE));\n            UIROOT.addChild(this.instance._ndTips = new cc.Node(SysDefine.SYS_TOPTIPS_NODE));\n            cc.director.once(cc.Director.EVENT_BEFORE_SCENE_LAUNCH, () => {\n                this.instance = null;\n            });            \n        }\n        return this.instance;\n    }\n\n    /** 预加载UIForm */\n    public async loadUIForm(prefabPath: string) {\n        let uiBase = await this._loadForm(prefabPath);\n        if(!uiBase) {\n            console.warn(`${uiBase}没有被成功加载`);\n            return null;\n        }\n        return uiBase;\n    }\n    \n    /**\n     * 加载显示一个UIForm\n     * @param prefabPath \n     * @param params \n     * @param formData \n     * @returns \n     */\n    public async openForm(prefabPath: string, params?: any, formData?: IFormData) {\n        if(!prefabPath || prefabPath.length <= 0) {\n            cc.warn(`${prefabPath}, 参数错误`);\n            return ;\n        }\n        if(this.checkFormShowing(prefabPath)) {\n            cc.warn(`${prefabPath}, 窗体正在显示中`);\n            return null;\n        }\n        let com = await this._loadForm(prefabPath);\n        if(!com) {\n            cc.warn(`${prefabPath} 加载失败了!`);\n            return null;\n        }\n        // 初始化窗体名称\n        com.fid = prefabPath;\n        com.formData = formData;\n        \n        switch(com.formType) {\n            case FormType.Screen:\n                await this.enterToScreen(com.fid, params);\n            break;\n            case FormType.Fixed:\n                await this.enterToFixed(com.fid, params);\n            break;\n            case FormType.Window:\n                await this.enterToPopup(com.fid, params);\n            break;\n            case FormType.Tips:                                  // 独立显示\n                await this.enterToTips(com.fid, params);\n            break;\n        }\n        \n        // 如果这个窗体在lru中存在, 那么立即删除它\n        if(com.closeType === ECloseType.LRU) {\n            this._LRUCache.remove(com.fid);\n        }\n    \n        return com;\n    }\n\n\n    /**\n     * 重要方法 关闭一个UIForm\n     * @param prefabPath \n     */\n    public async closeForm(prefabPath: string) {\n        if(!prefabPath || prefabPath.length <= 0) {\n            cc.warn(`${prefabPath}, 参数错误`);\n            return ;\n        };\n        let com = this._allForms[prefabPath];\n        if(!com) return false;\n        \n        switch(com.formType) {\n            case FormType.Screen:\n                await this.exitToScreen(prefabPath);\n            break;\n            case FormType.Fixed:                             // 普通模式显示\n                await this.exitToFixed(prefabPath);\n            break;\n            case FormType.Window:\n                await this.exitToPopup(prefabPath);\n                EventCenter.emit(EventType.WindowClosed, prefabPath);\n            break;\n            case FormType.Tips:\n                await this.exitToTips(prefabPath);\n            break;\n        }\n\n        EventCenter.emit(EventType.FormClosed, prefabPath);\n\n        if(com.formData) {\n            com.formData.onClose && com.formData.onClose();\n        }\n\n        // 根据closeType 处理\n        switch(com.closeType) {\n            case ECloseType.CloseAndDestory:\n                this.destoryForm(com);\n            break;\n            case ECloseType.LRU:\n                this.putLRUCache(com);\n            break;\n        }\n        return true;\n    }\n\n    /**\n     * 从窗口缓存中加载(如果没有就会在load加载), 并挂载到结点上\n     */\n    private async _loadForm(prefabPath: string): Promise<UIBase> {\n        let com = this._allForms[prefabPath];\n        if(com) return com;\n        return new Promise((resolve, reject) => {\n            if(this._loadingForm[prefabPath]) {\n                this._loadingForm[prefabPath].push(resolve);\n                return ;\n            }\n            this._loadingForm[prefabPath] = [resolve];\n            this._doLoadUIForm(prefabPath).then((com: UIBase) => {\n                for(const func of this._loadingForm[prefabPath]) {\n                    func(com);\n                }\n                this._loadingForm[prefabPath] = null;\n                delete this._loadingForm[prefabPath];\n            });\n        });\n    }\n\n\n    /**\n     * @param prefabPath \n     */\n    private async _doLoadUIForm(prefabPath: string) {\n        let prefab = await ResMgr.inst.loadFormPrefab(prefabPath);\n        let node = cc.instantiate(prefab);\n        let com = node.getComponent(UIBase);\n        if(!com) {\n            cc.warn(`${prefabPath} 结点没有绑定UIBase`);\n            return null;\n        }\n        node.active = false;                    // 避免baseCom调用了onload方法\n        switch(com.formType) {\n            case FormType.Screen:\n                this._ndScreen.addChild(node);\n            break;\n            case FormType.Fixed:\n                this._ndFixed.addChild(node);\n            break;\n            case FormType.Window:\n                this._ndPopUp.addChild(node);\n            break;\n            case FormType.Tips:\n                this._ndTips.addChild(node);\n            break;\n        }\n        this._allForms[prefabPath] = com;\n        \n        return com;\n    }\n\n    /** 添加到screen中 */\n    private async enterToScreen(fid: string, params: any) {\n        // 关闭其他显示的窗口 \n        let arr: Array<Promise<boolean>> = [];\n        for(let key in this._showingForms) {\n            arr.push(this._showingForms[key].closeSelf());\n        }\n        await Promise.all(arr);\n\n        let com = this._allForms[fid];\n        if(!com) return ;\n        this._showingForms[fid] = com;\n\n        AdapterMgr.inst.adapteByType(AdapterType.StretchHeight | AdapterType.StretchWidth, com.node);\n        \n        await com._preInit(params);\n        com.onShow(params);\n\n        await this.showEffect(com);\n        com.onAfterShow(params);\n    }\n\n    /** 添加到Fixed中 */\n    private async enterToFixed(fid: string, params: any) {\n        let com = this._allForms[fid];\n        if(!com) return ;\n        await com._preInit(params);\n        \n        com.onShow(params);\n        this._showingForms[fid] = com;\n        await this.showEffect(com);\n        com.onAfterShow(params);\n    }\n\n    /** 添加到popup中 */\n    private async enterToPopup(fid: string, params: any) {\n        let com = this._allForms[fid] as UIWindow;\n        if(!com) return ;\n        await com._preInit(params);\n\n        this._windows.push(com);\n        \n        for(let i=0; i<this._windows.length; i++) {\n            this._windows[i].node.zIndex = i+1;\n        }\n\n        com.onShow(params);\n        this._showingForms[fid] = com;\n\n        ModalMgr.inst.checkModalWindow(this._windows);\n        await this.showEffect(com);\n        com.onAfterShow(params);\n    }\n    \n    /** 加载到tips中 */\n    private async enterToTips(fid: string, params: any) {\n        let com = this._allForms[fid];\n        if(!com) return ;\n        await com._preInit(params);\n        this._tipsForms[fid] = com;\n        \n        com.onShow(params);\n        await this.showEffect(com);\n        com.onAfterShow(params);\n    }\n\n    private async exitToScreen(fid: string) {\n        let com = this._showingForms[fid];\n        if(!com) return ;\n        com.onHide();\n        await this.hideEffect(com);\n        com.onAfterHide();\n\n        this._showingForms[fid] = null;\n        delete this._showingForms[fid];\n    }\n   \n    private async exitToFixed(fid: string) {\n        let com = this._allForms[fid];\n        if(!com) return ;\n        com.onHide();\n        await this.hideEffect(com);\n        com.onAfterHide();\n\n        this._showingForms[fid] = null;\n        delete this._showingForms[fid];\n    }\n    \n    private async exitToPopup(fid: string) {\n        if(this._windows.length <= 0) return;\n        let com: UIWindow = null;\n        for(let i=this._windows.length-1; i>=0; i--) {\n            if(this._windows[i].fid === fid) {\n                com = this._windows[i];\n                this._windows.splice(i, 1);\n            }\n        }\n        if(!com) return ;\n        \n        com.onHide();\n        ModalMgr.inst.checkModalWindow(this._windows);\n        await this.hideEffect(com);\n        com.onAfterHide();\n\n        this._showingForms[fid] = null;\n        delete this._showingForms[fid];\n    }\n    \n    private async exitToTips(fid: string) {\n        let com = this._allForms[fid];\n        if(!com) return ;\n        com.onHide();\n        await this.hideEffect(com);\n        com.onAfterHide();\n\n        this._tipsForms[fid] = null;\n        delete this._tipsForms[fid];\n    }\n\n    private async showEffect(baseUI: UIBase) {\n        baseUI.node.active = true;\n        await baseUI.showEffect();\n    }\n    private async hideEffect(baseUI: UIBase) {\n        await baseUI.hideEffect();\n        baseUI.node.active = false;\n    }\n\n    /** 销毁 */\n    private destoryForm(com: UIBase) {\n        // 销毁动态加载的资源\n        ResMgr.inst.destoryDynamicRes(com.fid);\n        // 销毁prefab以及依赖的资源\n        ResMgr.inst.destoryFormPrefab(com.fid);\n        // 销毁node\n        com.node.destroy();\n        // 从allmap中删除\n        this._allForms[com.fid] = null;\n        delete this._allForms[com.fid];\n    }\n\n    /** LRU缓存控制 */\n    private putLRUCache(com: UIBase) {\n        this._LRUCache.put(com.fid);\n        if(!this._LRUCache.needDelete()) return ;\n        let deleteFid = this._LRUCache.deleteLastNode();\n        if(deleteFid) {\n            CC_DEBUG && console.log('close form id:', deleteFid, this._LRUCache.toString())\n            let com = this.getForm(deleteFid);\n            if(!com || !com.node) return ;\n            com && this.destoryForm(com);\n        }\n        \n    }\n\n    /** 窗体是否正在显示 */\n    public checkFormShowing(fid: string) {\n        let com = this._allForms[fid];\n        if (!com) return false;\n        return com.node.active;\n    }\n\n    /** 窗体是否正在加载 */\n    public checkFormLoading(prefabPath: string) {\n        let com = this._loadingForm[prefabPath];\n        return !!com;\n    }\n\n    /** 获得Component */\n    public getForm(fId: string) {\n        return this._allForms[fId];\n    }\n\n    public getUIROOT() {\n        return this._UIROOT;\n    }\n}\n\nif(CC_DEBUG) {\n    window['UIManager'] = UIManager;\n}"]}